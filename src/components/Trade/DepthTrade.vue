<template>
  <div class="depth-box trade">
    <div
      class="depth"
      id="depth"
    ></div>
  </div>
</template>
<script>
import echarts from 'echarts/lib/echarts'
import {mapState} from 'vuex'
require('echarts/lib/chart/line')
require('echarts/lib/component/tooltip')
export default {
  components: {},
  // props,
  data () {
    return {
      buys: [],
      sells: [],
      depthCharts: '',
      options: {
        backgroundColor: '#10172d',
        name: '123',
        title: {},
        textStyle: {
          color: '#b2b7d0'
        },
        grid: {
          left: '4%',
          top: '30px'
        },
        tooltip: {
          trigger: 'axis',
          backgroundColor: '#262A42',
          borderColor: '#262A42',
          borderRadius: 3,
          style: {
            color: '#c7cce6',
            width: '250px'

          },
          axisPointer: {
            type: 'line',
            lineStyle: {
              color: 'transparent'
            }
            // label: {
            //   show: true,
            //   formatter: '委托价:{value} ',
            // }
          },
          formatter: function (params) {
            console.log(params)
            return `
                      委托价：${params[0].data[0].toFixed(4)}<br/>
                      委托量：${params[0].data[1].toFixed(4)}
                      `
          }
        },
        xAxis: {
          type: 'category',
          boundaryGap: false
        },
        yAxis: {
          position: 'right',
          splitLine: {
            show: false
          }

        },
        series: [
          {
            name: '委托量',
            type: 'line',
            color: '#243235', // 填充顏色
            areaStyle: {},
            data: this.buys,
            symbolSize: 0
          },
          {
            name: '委托量',
            type: 'line',
            color: '#392231',
            areaStyle: {},
            data: this.sells,
            symbolSize: 0
          }
        ]
      }
    }
  },
  created () {
    this.buys = [
      [28408, 298.2393],
      [28412.73, 298.1026],
      [28420, 298.0637],
      [28431.52, 297.8637],
      [28440.11, 297.6414],
      [28443.62, 297.5412],
      [28444.44, 297.5064],
      [28451, 297.1222],
      [28456.25, 296.9462],
      [28460, 291.9462],
      [28498.21, 291.4539],
      [28499, 291.3734],
      [28500, 291.3234],
      [28500.01, 224.5802],
      [28501, 223.6892],
      [28502, 222.2285],
      [28508, 222.1085],
      [28509.23, 221.8894],
      [28510, 221.8794],
      [28512, 195.3248],
      [28522.67, 195.2248],
      [28529.81, 195.1775],
      [28538, 194.6775],
      [28538.03, 194.5835],
      [28543, 194.0835],
      [28545, 193.6796],
      [28555, 193.5846],
      [28560, 193.4906],
      [28561, 193.1166],
      [28567.1, 193.0366],
      [28588, 191.9152],
      [28600, 191.8952],
      [28608, 148.7652],
      [28613, 148.6652],
      [28613.6, 148.4652],
      [28617.97, 148.4379],
      [28625.8, 147.7379],
      [28640.04, 147.6792],
      [28650, 147.4509],
      [28651, 146.5279],
      [28651.99, 144.6],
      [28656, 144.6198],
      [28658, 144.4198],
      [28660, 144.4098],
      [28665, 144.0609],
      [28668, 143.9629],
      [28679.92, 143.8442],
      [28683.22, 143.7507],
      [28692, 143.1507],
      [28699, 142.1507],
      [28700, 141.8151],
      [28701.02, 139.9377],
      [28701.05, 138.1255],
      [28703.03, 137.4255],
      [28703.06, 136.9255],
      [28708, 136.2255],
      [28715.22, 136.1255],
      [28723.22, 135.8255],
      [28725.22, 135.4255],
      [28731.15, 135.2755],
      [28735, 134.505],
      [28736, 134.4235],
      [28737, 134.3973],
      [28737.18, 134.0392],
      [28738.97, 133.6586],
      [28740, 133.4239],
      [28750, 130.0492],
      [28750.03, 127.3695],
      [28750.22, 126.6843],
      [28752, 126.1155],
      [28753, 125.9955],
      [28756.74, 118.8093],
      [28780, 116.7823],
      [28780.06, 113.5318],
      [28797.03, 113.4388],
      [28800, 112.9388],
      [28808, 111.6639],
      [28822.89, 111.5639],
      [28822.92, 110.4512],
      [28847, 109.7512],
      [28850, 108.7512],
      [28855.53, 108.3624],
      [28855.56, 98.3624],
      [28856, 97.8624],
      [28860, 97.8424],
      [28866, 97.7731],
      [28871.66, 97.7531],
      [28882, 94.5521],
      [28888, 94.4521],
      [28888.88, 94.3117],
      [28889, 93.8617],
      [28890, 93.7617],
      [28900, 93.5424],
      [28901, 92.4248],
      [28908, 91.4248],
      [28915.73, 90.3248],
      [28932.8, 89.7748],
      [28937, 89.7708],
      [28940, 89.7673],
      [28942, 88.0072],
      [28943.53, 87.9725],
      [28950, 87.7925],
      [28955.03, 87.7325],
      [28960.03, 86.6425],
      [28961, 86.639],
      [28961.31, 86.516],
      [28962.09, 86.5085],
      [28973.4, 86.1875],
      [28980, 85.4875],
      [28981.52, 84.7804],
      [28993.91, 82.9104],
      [28999, 82.8971],
      [28999.88, 82.8951],
      [29000, 82.7833],
      [29002, 70.0585],
      [29008, 69.9385],
      [29010, 69.8385],
      [29010.03, 69.3709],
      [29010.06, 69.1907],
      [29018, 68.6907],
      [29020, 68.5656],
      [29022, 68.4313],
      [29022.03, 67.3976],
      [29050, 66.6976],
      [29053, 66.6292],
      [29055.13, 66.6192],
      [29066, 66.447],
      [29066.1, 65.9591],
      [29068, 65.9091],
      [29070, 65.4542],
      [29072, 65.1536],
      [29085, 65.1189],
      [29088, 65.0383],
      [29100, 65.0349],
      [29100.09, 49.8206],
      [29102, 49.6486],
      [29105, 49.1849],
      [29106.31, 49.1507],
      [29109.84, 49.0899],
      [29109.87, 48.6965],
      [29112.11, 45.4965],
      [29116.62, 45.491],
      [29128.14, 44.301],
      [29136, 43.3345],
      [29136.52, 42.3894],
      [29145.66, 42.3286],
      [29149, 42.2678],
      [29150, 42.1988],
      [29150.03, 5.69],
      [29150.04, 2.71]
    ]
    this.sells = [
      [29180, 0.8431],
      [29190, 18.7992],
      [29193.3, 18.9259],
      [29195, 20.1828],
      [29195.8, 22.1698],
      [29195.9, 22.2077],
      [29196, 22.2765],
      [29198, 24.2765],
      [29198.97, 25.3765],
      [29199, 25.809],
      [29199.96, 26.499],
      [29199.99, 33.7677],
      [29200, 49.6009],
      [29205, 49.6459],
      [29206, 50.2087],
      [29210, 50.6568],
      [29218, 50.9655],
      [29219.99, 51.7768],
      [29220, 53.2598],
      [29222, 53.297],
      [29230, 53.797],
      [29239.97, 54.487],
      [29240, 55.9015],
      [29247.82, 56.4415],
      [29247.85, 56.6107],
      [29249.57, 57.4907],
      [29249.6, 60.5383],
      [29250, 66.028],
      [29250.2, 66.064],
      [29257.95, 66.2636],
      [29260, 66.4753],
      [29269.9, 66.4803],
      [29270, 66.6234],
      [29271, 66.7512],
      [29274.52, 67.4512],
      [29276, 67.7385],
      [29279.88, 68.2385],
      [29279.91, 69.0251],
      [29280, 73.8076],
      [29282.97, 74.5076],
      [29283, 75.5076],
      [29288, 77.0269],
      [29289, 77.3816],
      [29290, 79.8187],
      [29294.87, 80.9187],
      [29294.9, 81.5802],
      [29294.99, 84.5802],
      [29295, 146.6652],
      [29296, 146.6951],
      [29297, 146.6978],
      [29298, 159.6089],
      [29298.71, 159.6438],
      [29298.99, 159.7133],
      [29299, 160.7382],
      [29299.8, 160.8211],
      [29299.9, 161.4211],
      [29300, 300.4619],
      [29301.03, 300.4669],
      [29305, 300.7669],
      [29306.5, 300.8169],
      [29307.13, 300.8404],
      [29310, 300.8414],
      [29329.8, 300.8434],
      [29348, 301.1026],
      [29349, 301.4128],
      [29350, 302.3845],
      [29352, 302.4092],
      [29359.97, 302.9092],
      [29360, 303.5622],
      [29361.1, 303.6374],
      [29379, 304.6374],
      [29380, 305.5176],
      [29383.2, 305.6176],
      [29384, 305.6877],
      [29386.8, 305.719],
      [29388, 308.4591],
      [29388.88, 308.5686],
      [29389.97, 317.5686],
      [29391, 317.5719],
      [29395, 317.5776],
      [29398, 317.8276],
      [29399, 317.9638],
      [29400, 345.3181],
      [29400.03, 346.3181],
      [29403.12, 346.3332],
      [29410, 347.3934],
      [29411, 347.4024],
      [29420, 347.6177],
      [29424.16, 347.6227],
      [29430, 348.6227],
      [29432, 348.7227],
      [29439.83, 348.7753],
      [29447.94, 349.4753],
      [29447.97, 349.6753],
      [29449, 351.7253],
      [29449.02, 351.9255],
      [29450, 387.399],
      [29450.01, 387.8074],
      [29458, 388.3074],
      [29460, 388.7188],
      [29466, 389.7418],
      [29468, 390.2208],
      [29469.98, 390.7208],
      [29470, 392.1821],
      [29477.98, 392.3321],
      [29480, 396.6028],
      [29486, 406.6028],
      [29488, 408.47],
      [29488.23, 408.9784],
      [29489, 410.1148],
      [29489.39, 410.7669],
      [29490, 412.4259],
      [29495, 412.8022],
      [29496, 412.9955],
      [29498, 414.1007],
      [29499, 512.2822],
      [29499.05, 512.8822],
      [29499.8, 512.9181],
      [29499.98, 513.0181],
      [29499.99, 514.0064],
      [29500, 687.6153],
      [29500.1, 687.6186],
      [29500.88, 690.6186],
      [29501, 690.622],
      [29501.19, 690.722],
      [29509, 690.8218],
      [29510, 690.8348],
      [29517, 691.8756],
      [29520, 692.1256],
      [29522, 692.1297],
      [29522.59, 692.1968],
      [29525, 692.5569],
      [29528, 692.6569],
      [29534, 692.6599],
      [29536, 696.6687],
      [29540, 697.6667],
      [29540.68, 697.6717],
      [29543, 697.6751],
      [29544, 697.7816],
      [29545, 698.488],
      [29546, 698.4957],
      [29546.99, 700.4957],
      [29548.99, 700.738],
      [29549.01, 700.749],
      [29550, 706.5007],
      [29553, 706.7758],
      [29555, 708.7783],
      [29555.55, 708.8857],
      [29558, 709.2143],
      [29560, 710.2282]
    ]
    // this.options.series[0].data = this.buys
    // this.options.series[1].data = this.sells
    // this.depthCharts.setOption(this.options)
  },
  mounted () {
    this.drawLine()
  },
  activited () {},
  update () {},
  beforeRouteUpdate () {},
  methods: {
    drawLine () {
      this.depthCharts = echarts.init(document.getElementById('depth'))
      this.depthCharts.setOption(this.options)
      window.onresize = this.depthCharts.resize
    }
  },
  filter: {},
  computed: {
    ...mapState({
      socketData: state => state.common.socketData,
      depthData: state => state.common.socketData.depthData
      // buy: state => state.common.socketData.depthData.buy,
      // sell: state => state.common.socketData.depthData.sell
    })
    // buys () {
    //   return this.depthData.buy
    // },
    // sells () {
    //   return this.depthData.sell
    // }
  },
  watch: {
    depthData (newVal) {
      // console.log(newVal)
      this.options.series[0].data = newVal.buy
      this.options.series[1].data = newVal.sell
      this.depthCharts.setOption(this.options)
    }
    // buy (newVal) {
    //   // console.log(newVal)
    //   // this.buys = newVal
    //
    //   // this.options.series[0].data = newVal
    //   // this.depthCharts.setOption(this.options)
    // },
    // sell (newVal) {
    //   // console.log(newVal)
    //   // this.sells = newVal
    //   this.options.series[1].data = newVal
    //   this.depthCharts.setOption(this.options)
    // }
  }
}
</script>
<style scoped lang="scss">
  .depth-box{
    margin:10px auto;
    >.depth{
      width:100%;
      height:445px;
    }
  }
</style>
